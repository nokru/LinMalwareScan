#!/bin/bash


#VAR for Output
DISKNAME=water

#phpmalwarefinder
cd /opt/php-malware-finder/php-malware-finder
chmod +x phpmalwarefinder
./phpmalwarefinder /mnt/vmdisk > /opt/$DISKNAME/phpmalwarefind.txt 2>&1

#maldetect
maldet -a /mnt/vmdisk/ -l > /opt/$DISKNAME/maldetect.txt 2>&1

#yara
cd /opt
yara -r --no-warnings rules/antidebug_antivm_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/antivm.txt 2>&1
yara -r --no-warnings rules/capabilities_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/capabilities.txt 2>&1
yara -r --no-warnings rules/crypto_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/crypto.txt 2>&1
yara -r --no-warnings rules/cve_rules_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/cve.txt 2>&1
yara -r --no-warnings rules/email_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/email.txt 2>&1
yara -r --no-warnings rules/exploit_kits_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/exploit.txt 2>&1
yara -r --no-warnings rules/index_w_mobile.yar /mnt/vmdisk/ > /opt/$DISKNAME/mobile.txt 2>&1
yara -r --no-warnings rules/maldocs_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/maldocs.txt 2>&1
yara -r --no-warnings rules/malware_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/malware.txt 2>&1
yara -r --no-warnings rules/mobile_malware_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/mobilemalware.txt 2>&1
yara -r --no-warnings rules/packers_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/packers.txt 2>&1
yara -r --no-warnings rules/webshells_index.yar /mnt/vmdisk/ > /opt/$DISKNAME/webshells.txt 2>&1
